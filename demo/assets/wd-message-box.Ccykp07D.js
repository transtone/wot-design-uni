import{r as e,U as a,d as l,q as t,N as o,v as s,o as u,c as n,w as r,e as i,n as c,f as d,t as v,p as m,g as p,u as f,F as _,x as w,i as x}from"./index--UwMP9LN.js";import{J as y,f as b,k as g,C as h,t as C,b as k}from"./page-wraper.CWk-n8Ds.js";import{_ as V}from"./wd-button.D3kRr9dh.js";import{_ as z}from"./wd-input.BswaWSSu.js";import{u as B}from"./useTranslate.DB6DQ0QV.js";const E="__MESSAGE_OPTION__",I={title:"",showCancelButton:!1,show:!1,closeOnClickModal:!0,msg:"",type:"alert",inputType:"text",inputValue:"",inputValidate:null,showErr:!1,zIndex:99,lazyRender:!0,inputError:""};function T(l=""){const t=e(I);a(l?E+l:E,t);const o=e=>a=>{const l=y({type:e},"string"==typeof a?{title:a}:a);return"confirm"===l.type||"prompt"===l.type?l.showCancelButton=!0:l.showCancelButton=!1,s(l)},s=e=>new Promise(((a,l)=>{const o=y(I,"string"==typeof e?{title:e}:e);t.value=y(o,{show:!0,onConfirm:e=>{a(e)},onCancel:e=>{l(e)}})})),u=o("alert"),n=o("confirm"),r=o("prompt");return{show:s,alert:u,confirm:n,prompt:r,close:()=>{t.value.show=!1}}}const j=k(l({name:"wd-message-box",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"},props:{...b,selector:String},setup(a){const l=a,{translate:y}=B("message-box"),b=t((()=>`wd-message-box__container ${l.customClass}`)),k=t((()=>`wd-message-box__body ${G.value?"":"is-no-title"} ${"prompt"===A.value?"is-prompt":""}`)),T=l.selector?E+l.selector:E,j=o(T,e(I)),M=e("");let O=null,P=null,S=null;const $=e(!1),G=e(""),N=e(!1),U=e(!0),R=e(""),q=e(""),A=e("alert"),F=e("text"),H=e(""),J=e(""),D=e();let K=null;const L=e(""),Q=e(!1),W=e(99),X=e(!0);function Y(e){if(("modal"!==e||U.value)&&("prompt"!==A.value||"confirm"!==e||function(){if(D.value&&!D.value.test(String(H.value)))return Q.value=!0,!1;if("function"==typeof K){if(!K(H.value))return Q.value=!0,!1}return Q.value=!1,!0}()))switch(e){case"confirm":S?S({resolve:a=>{a&&Z({action:e,value:H.value})}}):Z({action:e,value:H.value});break;case"cancel":ee({action:e});break;default:ee({action:"modal"})}}function Z(e){$.value=!1,h(O)&&O(e)}function ee(e){$.value=!1,h(P)&&P(e)}function ae({value:e}){""!==e?H.value=e:Q.value=!1}return s((()=>j.value),(e=>{var a;(a=e)&&(G.value=C(a.title)?a.title:"",N.value=!!C(a.showCancelButton)&&a.showCancelButton,$.value=a.show,U.value=a.closeOnClickModal,R.value=a.confirmButtonText,q.value=a.cancelButtonText,M.value=a.msg,A.value=a.type,F.value=a.inputType,H.value=a.inputValue,J.value=a.inputPlaceholder,D.value=a.inputPattern,K=a.inputValidate,O=a.onConfirm,P=a.onCancel,S=a.beforeConfirm,L.value=a.inputError,Q.value=a.showErr,W.value=a.zIndex,X.value=a.lazyRender)}),{deep:!0,immediate:!0}),s((()=>$.value),(e=>{!1===e&&(Q.value=!1)}),{deep:!0,immediate:!0}),(e,a)=>{const l=x;return u(),n(l,null,{default:r((()=>[i(g,{transition:"zoom-in",modelValue:$.value,"onUpdate:modelValue":a[3]||(a[3]=e=>$.value=e),"close-on-click-modal":U.value,"lazy-render":X.value,"custom-class":"wd-message-box",onClickModal:a[4]||(a[4]=e=>Y("modal")),"z-index":W.value,duration:200},{default:r((()=>[i(l,{class:c(b.value)},{default:r((()=>[i(l,{class:c(k.value)},{default:r((()=>[G.value?(u(),n(l,{key:0,class:"wd-message-box__title"},{default:r((()=>[d(v(G.value),1)])),_:1})):m("",!0),i(l,{class:"wd-message-box__content"},{default:r((()=>["prompt"===A.value?(u(),p(_,{key:0},[i(z,{modelValue:H.value,"onUpdate:modelValue":a[0]||(a[0]=e=>H.value=e),type:F.value,size:"large",placeholder:J.value||"请输入",onInput:ae},null,8,["modelValue","type","placeholder"]),Q.value?(u(),n(l,{key:0,class:"wd-message-box__input-error"},{default:r((()=>[d(v(L.value||f(y)("inputNoValidate")),1)])),_:1})):m("",!0)],64)):m("",!0),w(e.$slots,"default",{},(()=>[d(v(M.value),1)]),!0)])),_:3})])),_:3},8,["class"]),i(l,{class:c("wd-message-box__actions "+(N.value?"wd-message-box__flex":"wd-message-box__block"))},{default:r((()=>[N.value?(u(),n(V,{key:0,type:"info",block:"","custom-style":"margin-right: 16px;",onClick:a[1]||(a[1]=e=>Y("cancel"))},{default:r((()=>[d(v(q.value||f(y)("cancel")),1)])),_:1})):m("",!0),i(V,{block:"",onClick:a[2]||(a[2]=e=>Y("confirm"))},{default:r((()=>[d(v(R.value||f(y)("confirm")),1)])),_:1})])),_:1},8,["class"])])),_:3},8,["class"])])),_:3},8,["modelValue","close-on-click-modal","lazy-render","z-index"])])),_:3})}}}),[["__scopeId","data-v-e2f43b08"]]);export{j as _,T as u};
